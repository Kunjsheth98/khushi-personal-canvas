<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khushi Mode</title>

<style>
body{
  margin:0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(135deg,#f5e9ff,#ffffff);
  text-align:center;
  padding:14px;
}
h1{color:#6b21a8;margin:6px 0;}
#dayText{font-size:13px;color:#555;margin-bottom:8px;}

.toolbar{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:8px;
  margin-bottom:10px;
}

button{
  padding:10px 14px;
  border-radius:18px;
  border:none;
  font-size:14px;
  background:#ede9fe;
  cursor:pointer;
}

canvas{
  background:#fff;
  border-radius:22px;
  display:block;
  margin:10px auto;
  touch-action:none;
  cursor:crosshair;
}

#message{
  font-size:13px;
  color:#444;
  min-height:18px;
}
</style>
</head>

<body>

<h1>KHUSHI MODE</h1>
<div id="dayText"><h2>I Love YOU</h2></div>

<div class="toolbar">
  <button onclick="setMode('paint')">ðŸŒˆ Paint</button>
  <button onclick="setMode('animated')">ðŸ’« Flow Brush</button>
  <button onclick="setMode('mandala')">ðŸŒ€ Mandala</button>
  <button onclick="setMode('trace')">ðŸ–‹ Trace</button>
  <button onclick="setMode('stamp')">âœ¨ Doodle</button>
  <button onclick="undo()">â†© Undo</button>
</div>

<canvas id="canvas" width="460" height="460"></canvas>

<div class="toolbar">
  <button onclick="nextTheme()">ðŸŽ¨ Theme</button>
  <button onclick="toggleMusic()">ðŸŽµ Music</button>
  <button onclick="saveArt()">ðŸ’¾ Save</button>
  <button onclick="resetCanvas()">ðŸŒ¸ Reset</button>
</div>

<div id="message"></div>

<audio id="bgMusic" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
/* DAY COUNTER */
const start = new Date("2024-01-01");
document.getElementById("dayText").innerText =
  `Day ${Math.floor((new Date()-start)/(1000*60*60*24))+1} â€” Welcome back`;

/* CANVAS SETUP */
const canvas = document.getElementById("canvas");
const ctx = canvas.getContext("2d");
let drawing = false;
let mode = "paint";
let history = [];
let hue = 0;
let mandalaPoints = 12;

/* THEMES */
const themes = [
  {name:"Lavender Mist", colors:["#ddd6fe","#c4b5fd","#a78bfa"]},
  {name:"Petal Dream", colors:["#fda4af","#fecdd3","#f9a8d4"]},
  {name:"Ocean Calm", colors:["#bae6fd","#7dd3fc","#38bdf8"]},
  {name:"Sunrise Glow", colors:["#fde68a","#fbbf24","#f97316"]},
  {name:"Mint Soft", colors:["#bbf7d0","#86efac","#4ade80"]}
];
let themeIndex = 0;
let currentTheme = themes[0];

function nextTheme(){
  themeIndex = (themeIndex+1)%themes.length;
  currentTheme = themes[themeIndex];
  msg("Theme: " + currentTheme.name);
}

/* INPUT HANDLERS */
canvas.addEventListener("mousedown",startDraw);
canvas.addEventListener("mousemove",draw);
canvas.addEventListener("mouseup",()=>drawing=false);
canvas.addEventListener("mouseleave",()=>drawing=false);

canvas.addEventListener("touchstart",startDraw);
canvas.addEventListener("touchmove",draw);
canvas.addEventListener("touchend",()=>drawing=false);

function startDraw(e){
  drawing = true;
  history.push(canvas.toDataURL());
  draw(e);
}

function draw(e){
  if(!drawing) return;
  const r = canvas.getBoundingClientRect();
  const x = (e.touches ? e.touches[0].clientX : e.clientX) - r.left;
  const y = (e.touches ? e.touches[0].clientY : e.clientY) - r.top;

  if(mode==="paint") gradientDot(x,y);
  if(mode==="animated") animatedBrush(x,y);
  if(mode==="mandala") mandalaDraw(x,y);
  if(mode==="stamp") stamp(x,y);
}

/* GRADIENT DOT */
function gradientDot(x,y){
  const g = ctx.createRadialGradient(x,y,2,x,y,30);
  currentTheme.colors.forEach((c,i)=>{
    g.addColorStop(i/(currentTheme.colors.length-1),c);
  });
  ctx.fillStyle = g;
  ctx.beginPath();
  ctx.arc(x,y,26,0,Math.PI*2);
  ctx.fill();
}

/* ANIMATED GRADIENT BRUSH */
function animatedBrush(x,y){
  hue = (hue + 1) % 360;
  const g = ctx.createRadialGradient(x,y,2,x,y,30);
  g.addColorStop(0,`hsla(${hue},80%,70%,0.9)`);
  g.addColorStop(1,`hsla(${hue+40},80%,60%,0.25)`);
  ctx.fillStyle = g;
  ctx.beginPath();
  ctx.arc(x,y,26,0,Math.PI*2);
  ctx.fill();
}

/* MANDALA DRAW */
function mandalaDraw(x,y){
  const cx = canvas.width/2;
  const cy = canvas.height/2;
  const dx = x - cx;
  const dy = y - cy;

  for(let i=0;i<mandalaPoints;i++){
    const a = (Math.PI*2/mandalaPoints)*i;
    const rx = cx + dx*Math.cos(a) - dy*Math.sin(a);
    const ry = cy + dx*Math.sin(a) + dy*Math.cos(a);
    animatedBrush(rx,ry);
  }
}

/* DOODLE STAMP */
function stamp(x,y){
  ctx.strokeStyle = currentTheme.colors[Math.floor(Math.random()*currentTheme.colors.length)];
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.arc(x,y,20,Math.random()*Math.PI,Math.random()*Math.PI*2);
  ctx.stroke();
}

/* TRACE MODE */
function setMode(m){
  mode = m;
  msg("Mode: " + m);
  if(m==="trace") drawGhost();
}

function drawGhost(){
  ctx.save();
  ctx.globalAlpha = 0.15;
  ctx.strokeStyle = "#999";
  ctx.lineWidth = 4;
  ctx.beginPath();
  ctx.moveTo(80,230);
  ctx.bezierCurveTo(160,80,300,380,380,230);
  ctx.stroke();
  ctx.restore();
}

/* UNDO */
function undo(){
  if(!history.length) return;
  const img = new Image();
  img.src = history.pop();
  img.onload = ()=>ctx.drawImage(img,0,0);
}

/* RESET */
function resetCanvas(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  history=[];
  msg("Fresh canvas ðŸŒ¸");
}

/* SAVE */
function saveArt(){
  const a=document.createElement("a");
  a.download="khushi-art.png";
  a.href=canvas.toDataURL();
  a.click();
}

/* MUSIC */
const music=document.getElementById("bgMusic");
let playing=false;
function toggleMusic(){
  playing ? music.pause() : music.play();
  playing = !playing;
}

/* MESSAGE */
function msg(t){
  document.getElementById("message").innerText=t;
}
</script>

</body>
</html>
