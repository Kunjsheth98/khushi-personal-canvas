<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>Khushi Mode</title>
<style>
body{
margin:0;
font-family:system-ui;
background:linear-gradient(135deg,#f3e8ff,#ffffff);
text-align:center;
padding:12px;
}
h1{color:#6d28d9;margin:4px;}
#modeDisplay{font-weight:600;color:#7c3aed;margin-bottom:6px;}
#challenge{margin-bottom:8px;color:#444;font-size:14px;}
.bar{
display:flex;
flex-wrap:wrap;
justify-content:center;
gap:8px;
margin-bottom:8px;
}
button,input,select{
padding:8px 12px;
border-radius:18px;
border:none;
background:#ede9fe;
font-size:13px;
}
canvas{
background:#fff;
border-radius:26px;
box-shadow:0 10px 28px rgba(0,0,0,0.08);
touch-action:none;
display:block;
margin:10px auto;
}
#gallery{
display:flex;
gap:8px;
overflow-x:auto;
padding:8px;
}
#gallery img{
width:80px;
height:80px;
border-radius:14px;
cursor:pointer;
}
</style>
</head>
<body>

<h1>KHUSHI MODE</h1>
<div id="modeDisplay">Mode: Paint</div>
<div id="challenge"></div>

<div class="bar">
<button onclick="setMode('paint')">ğŸ¨</button>
<button onclick="setMode('mandala')">ğŸŒ€</button>
<button onclick="setMode('doodle')">âœï¸</button>
<button onclick="setMode('galaxy')">ğŸŒŒ</button>
<button onclick="setMode('bloom')">ğŸŒº</button>
<button onclick="setMode('silk')">ğŸ§µ</button>
<button onclick="setMode('orbit')">ğŸ§¬</button>
<button onclick="setMode('breathe')">ğŸŒ¬ï¸</button>
<button onclick="setMode('teddy')">ğŸ§¸</button>
</div>

<div class="bar">
<input type="color" id="c1" value="#8b5cf6">
<input type="color" id="c2" value="#ec4899">
<button onclick="toggleGradient()">ğŸŒˆ</button>
<input type="range" id="size" min="4" max="60" value="20">
</div>

<div class="bar">
<input type="range" id="symmetry" min="4" max="24" value="12">
<span>Symmetry</span>
<select id="mandalaStyle">
<option value="classic">Classic</option>
<option value="flower">Flower</option>
<option value="spiral">Spiral</option>
<option value="kaleido">Kaleido</option>
<option value="dots">Dots</option>
</select>
</div>

<canvas id="canvas"></canvas>

<div class="bar">
<button onclick="undo()">â†©</button>
<button onclick="toggleMusic()">ğŸµ</button>
<button onclick="resetCanvas()">â™»</button>
<button onclick="saveArt()">ğŸ’¾</button>
<button onclick="exportSticker()">ğŸŸ Sticker</button>
</div>

<div id="gallery"></div>

<audio id="music" loop>
<source src="music.mp3">
</audio>

<script>
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");

function resize(){
let size=Math.min(window.innerWidth*0.92,520);
canvas.width=size;
canvas.height=size;
}
resize();
window.addEventListener("resize",resize);

let drawing=false,mode="paint",history=[];
let gradient=true,teddyStage=0,breathPhase=0;

const c1=document.getElementById("c1");
const c2=document.getElementById("c2");
const sizeSlider=document.getElementById("size");
const symmetrySlider=document.getElementById("symmetry");
const mandalaStyle=document.getElementById("mandalaStyle");

function setMode(m){
mode=m;
modeDisplay.innerText="Mode: "+m;
}

function toggleGradient(){gradient=!gradient;}

function getPos(e){
const rect=canvas.getBoundingClientRect();
return{
x:(e.touches?e.touches[0].clientX:e.clientX)-rect.left,
y:(e.touches?e.touches[0].clientY:e.clientY)-rect.top
};
}

canvas.addEventListener("mousedown",e=>{drawing=true;history.push(canvas.toDataURL());draw(e);});
canvas.addEventListener("mousemove",draw);
canvas.addEventListener("mouseup",()=>drawing=false);
canvas.addEventListener("touchstart",e=>{drawing=true;history.push(canvas.toDataURL());draw(e);},{passive:false});
canvas.addEventListener("touchmove",draw,{passive:false});
canvas.addEventListener("touchend",()=>drawing=false);

function brush(x,y){
if(!gradient)return c1.value;
let g=ctx.createLinearGradient(x-30,y-30,x+30,y+30);
g.addColorStop(0,c1.value);
g.addColorStop(1,c2.value);
return g;
}

function draw(e){
if(!drawing)return;
let {x,y}=getPos(e);

if(mode==="paint"){
ctx.fillStyle=brush(x,y);
ctx.beginPath();
ctx.arc(x,y,sizeSlider.value,0,Math.PI*2);
ctx.fill();
}

if(mode==="mandala"){
let cx=canvas.width/2,cy=canvas.height/2;
let dx=x-cx,dy=y-cy;
let segments=symmetrySlider.value;
for(let i=0;i<segments;i++){
let angle=2*Math.PI/segments*i;
let px=cx+dx*Math.cos(angle)-dy*Math.sin(angle);
let py=cy+dx*Math.sin(angle)+dy*Math.cos(angle);
ctx.fillStyle=brush(px,py);

if(mandalaStyle.value==="classic"){
ctx.beginPath();ctx.arc(px,py,6,0,Math.PI*2);ctx.fill();
}
if(mandalaStyle.value==="flower"){
ctx.beginPath();ctx.ellipse(px,py,18,8,angle,0,Math.PI*2);ctx.strokeStyle=brush(px,py);ctx.stroke();
}
if(mandalaStyle.value==="spiral"){
ctx.beginPath();ctx.arc(px+i*2,py+i*2,4,0,Math.PI*2);ctx.fill();
}
if(mandalaStyle.value==="kaleido"){
ctx.beginPath();ctx.arc(px,py,6,0,Math.PI*2);ctx.fill();
ctx.beginPath();ctx.arc(canvas.width-px,py,6,0,Math.PI*2);ctx.fill();
}
if(mandalaStyle.value==="dots"){
ctx.beginPath();ctx.arc(px,py,3,0,Math.PI*2);ctx.fill();
}
}
}

if(mode==="galaxy"){
for(let i=0;i<6;i++){
ctx.fillStyle=brush(x,y);
ctx.beginPath();
ctx.arc(x+Math.random()*20,y+Math.random()*20,2,0,Math.PI*2);
ctx.fill();
}
}

if(mode==="bloom"){
for(let i=0;i<6;i++){
ctx.strokeStyle=brush(x,y);
ctx.beginPath();
ctx.ellipse(x,y,20,8,i*Math.PI/3,0,Math.PI*2);
ctx.stroke();
}
}

if(mode==="silk"){
ctx.strokeStyle=brush(x,y);
ctx.beginPath();
ctx.moveTo(x,y);
ctx.quadraticCurveTo(x+20,y-20,x+40,y);
ctx.stroke();
}

if(mode==="orbit"){
for(let i=0;i<6;i++){
ctx.fillStyle=brush(x,y);
ctx.beginPath();
ctx.arc(x+Math.cos(i)*sizeSlider.value,y+Math.sin(i)*sizeSlider.value,4,0,Math.PI*2);
ctx.fill();
}
}

if(mode==="breathe"){
breathPhase+=0.05;
let r=sizeSlider.value+(Math.sin(breathPhase)*8);
ctx.fillStyle=brush(x,y);
ctx.beginPath();
ctx.arc(x,y,r,0,Math.PI*2);
ctx.fill();
}

if(mode==="teddy"){
buildTeddy(x,y);
}
}

function buildTeddy(x,y){
ctx.fillStyle="#a16207";
if(teddyStage===0){ctx.beginPath();ctx.arc(x,y,40,0,Math.PI*2);ctx.fill();}
if(teddyStage===1){
ctx.beginPath();ctx.arc(x-30,y-40,20,0,Math.PI*2);ctx.fill();
ctx.beginPath();ctx.arc(x+30,y-40,20,0,Math.PI*2);ctx.fill();
}
if(teddyStage===2){
ctx.fillStyle="#000";
ctx.beginPath();ctx.arc(x-15,y-5,6,0,Math.PI*2);ctx.fill();
ctx.beginPath();ctx.arc(x+15,y-5,6,0,Math.PI*2);ctx.fill();
}
if(teddyStage===3){
ctx.fillStyle="#000";
ctx.beginPath();ctx.arc(x,y+10,8,0,Math.PI*2);ctx.fill();
}
teddyStage=(teddyStage+1)%4;
}

function undo(){
if(!history.length)return;
let img=new Image();
img.src=history.pop();
img.onload=()=>ctx.drawImage(img,0,0);
}

function resetCanvas(){
ctx.clearRect(0,0,canvas.width,canvas.height);
history=[];
teddyStage=0;
}

function saveArt(){
let data=canvas.toDataURL();
let img=document.createElement("img");
img.src=data;
img.onclick=()=>window.open(data);
gallery.prepend(img);
}

function exportSticker(){
let temp=document.createElement("canvas");
temp.width=canvas.width;
temp.height=canvas.height;
let tctx=temp.getContext("2d");
tctx.drawImage(canvas,0,0);
let link=document.createElement("a");
link.download="sticker.png";
link.href=temp.toDataURL("image/png");
link.click();
}

const music=document.getElementById("music");
let playing=false;
function toggleMusic(){playing?music.pause():music.play();playing=!playing;}

const challenges=[
"Draw something that feels safe.",
"Create a peaceful mandala.",
"Build your own teddy.",
"Make a galaxy of dreams.",
"Draw your calm energy."
];
challenge.innerText="ğŸ–Œ "+challenges[new Date().getDate()%challenges.length];
</script>

</body>
</html>
