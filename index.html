<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Khushi Mode â€“ Art Space</title>

<style>
body{
  margin:0;
  font-family: system-ui, sans-serif;
  background: linear-gradient(135deg,#f5e9ff,#ffffff);
  text-align:center;
  padding:14px;
}
h1{color:#6b21a8;margin:6px 0;}
#dayText{font-size:13px;color:#555;margin-bottom:6px;}

.toolbar{
  display:flex;
  flex-wrap:wrap;
  justify-content:center;
  gap:8px;
  margin-bottom:8px;
}

button, select{
  padding:10px 14px;
  border-radius:18px;
  border:none;
  font-size:14px;
  background:#ede9fe;
  cursor:pointer;
}

canvas{
  background:#fff;
  border-radius:22px;
  display:block;
  margin:10px auto;
  touch-action:none;
  cursor:crosshair;
}

#message{font-size:13px;color:#444;min-height:18px;}
</style>
</head>

<body>

<h1>KHUSHI MODE</h1>
<div id="dayText"></div>

<div class="toolbar">
  <button onclick="setMode('flow')">ðŸ’« Flow</button>
  <button onclick="setMode('mandala')">ðŸŒ€ Mandala</button>
  <button onclick="setMode('mirror')">ðŸªž Mirror</button>
  <button onclick="setMode('trace')">ðŸ–‹ Trace</button>
  <button onclick="undo()">â†© Undo</button>
</div>

<div class="toolbar">
  <select onchange="setMood(this.value)">
    <option value="">Mood palette</option>
    <option value="calm">Calm</option>
    <option value="soft">Soft</option>
    <option value="playful">Playful</option>
    <option value="heavy">Heavy</option>
    <option value="hopeful">Hopeful</option>
  </select>
  <button onclick="randomGradient()">ðŸŒˆ Mix</button>
</div>

<canvas id="canvas" width="480" height="480"></canvas>

<div class="toolbar">
  <button onclick="nextDoodle()">ðŸŽ² Doodle Theme</button>
  <button onclick="toggleMusic()">ðŸŽµ Music</button>
  <button onclick="saveArt()">ðŸ’¾ Save</button>
  <button onclick="resetCanvas()">ðŸŒ¸ Reset</button>
</div>

<div id="message"></div>

<audio id="bgMusic" loop>
  <source src="music.mp3" type="audio/mpeg">
</audio>

<script>
/* DAY */
const start=new Date("2024-01-01");
dayText.innerText=`Day ${Math.floor((new Date()-start)/(1000*60*60*24))+1} â€” Welcome back`;

/* CANVAS */
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
let drawing=false, mode="flow", history=[];
let hue=0, mandalaPoints=12;

/* PALETTES */
let palette=["#ddd6fe","#c4b5fd","#a78bfa"];
const moods={
 calm:["#bae6fd","#7dd3fc","#38bdf8"],
 soft:["#fbcfe8","#f9a8d4","#fecdd3"],
 playful:["#fde68a","#fbbf24","#f97316"],
 heavy:["#a5b4fc","#818cf8","#6366f1"],
 hopeful:["#bbf7d0","#86efac","#4ade80"]
};

/* INPUT */
canvas.addEventListener("mousedown",startDraw);
canvas.addEventListener("mousemove",draw);
canvas.addEventListener("mouseup",()=>drawing=false);
canvas.addEventListener("mouseleave",()=>drawing=false);
canvas.addEventListener("touchstart",startDraw);
canvas.addEventListener("touchmove",draw);
canvas.addEventListener("touchend",()=>drawing=false);

function startDraw(e){
 drawing=true;
 history.push(canvas.toDataURL());
 draw(e);
}

function draw(e){
 if(!drawing)return;
 const r=canvas.getBoundingClientRect();
 const x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;
 const y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;

 if(mode==="flow") flowBrush(x,y);
 if(mode==="mandala") mandala(x,y);
 if(mode==="mirror") mirrorDraw(x,y);
}

/* FLOW BRUSH */
function flowBrush(x,y){
 hue=(hue+1)%360;
 const g=ctx.createRadialGradient(x,y,2,x,y,36);
 g.addColorStop(0,`hsla(${hue},80%,70%,0.9)`);
 g.addColorStop(1,`hsla(${hue+40},80%,60%,0.15)`);
 ctx.fillStyle=g;
 ctx.beginPath();
 ctx.arc(x,y,30,0,Math.PI*2);
 ctx.fill();
}

/* MANDALA */
function mandala(x,y){
 const cx=canvas.width/2, cy=canvas.height/2;
 const dx=x-cx, dy=y-cy;
 for(let i=0;i<mandalaPoints;i++){
  const a=(Math.PI*2/mandalaPoints)*i;
  flowBrush(cx+dx*Math.cos(a)-dy*Math.sin(a),
            cy+dx*Math.sin(a)+dy*Math.cos(a));
 }
}

/* MIRROR */
function mirrorDraw(x,y){
 flowBrush(x,y);
 flowBrush(canvas.width-x,y);
}

/* TRACE */
function setMode(m){
 mode=m;
 msg("Mode: "+m);
 if(m==="trace") ghost();
}

function ghost(){
 ctx.save();
 ctx.globalAlpha=0.15;
 ctx.strokeStyle="#999";
 ctx.lineWidth=4;
 ctx.beginPath();
 ctx.moveTo(90,240);
 ctx.bezierCurveTo(180,80,300,400,390,240);
 ctx.stroke();
 ctx.restore();
}

/* DOODLES */
const doodles=[
 "Flow in circles",
 "Petal loops",
 "Spiral release",
 "Wave lines",
 "Heart rhythm"
];
let d=0;
function nextDoodle(){
 d=(d+1)%doodles.length;
 msg("Doodle: "+doodles[d]);
}

/* PALETTE */
function setMood(m){
 if(moods[m]) palette=moods[m];
 msg("Mood palette set");
}
function randomGradient(){
 palette=[`hsl(${Math.random()*360},80%,70%)`,
          `hsl(${Math.random()*360},80%,60%)`,
          `hsl(${Math.random()*360},80%,50%)`];
 msg("Mixed gradient ðŸŽ¨");
}

/* UNDO */
function undo(){
 if(!history.length)return;
 const img=new Image();
 img.src=history.pop();
 img.onload=()=>ctx.drawImage(img,0,0);
}

/* SAVE */
function saveArt(){
 const a=document.createElement("a");
 a.download="khushi-art.png";
 a.href=canvas.toDataURL();
 a.click();
}

/* RESET */
function resetCanvas(){
 ctx.clearRect(0,0,canvas.width,canvas.height);
 history=[];
 msg("Fresh canvas ðŸŒ¸");
}

/* MUSIC */
const music=document.getElementById("bgMusic");
let play=false;
function toggleMusic(){
 play?music.pause():music.play();
 play=!play;
}

/* MSG */
function msg(t){message.innerText=t;}
</script>

</body>
</html>
